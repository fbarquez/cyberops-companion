# Incident Report Template

## Header Information

**Incident ID:** {{ incident.id }}
**Title:** {{ incident.title }}
**Severity:** {{ incident.severity | upper }}
**Status:** {{ incident.status | upper }}

**Report Generated:** {{ generated_at }}
**Analyst:** {{ incident.analyst_name }}

---

## Executive Summary

**Detection Source:** {{ incident.detection_source | replace('_', ' ') | title }}
**Initial Indicator:** {{ incident.initial_indicator or 'Not specified' }}

**Affected Systems:** {{ affected_systems or 'None documented' }}

**Response Progress:** {{ progress.percentage }}% complete ({{ progress.completed_phases }}/{{ progress.total_phases }} phases)

### Description

{{ incident.description or 'No description provided.' }}

---

## Timeline

| Phase | Started | Completed | Duration |
|-------|---------|-----------|----------|
{% for entry in timeline %}
| {{ entry.phase | replace('_', ' ') | title }} | {{ entry.started_at[:19] if entry.started_at else '-' }} | {{ entry.completed_at[:19] if entry.completed_at else '-' }} | {{ entry.duration or '-' }} |
{% endfor %}

---

## Phase Details

{% for phase in phases %}
### {{ phase.name }}

**Status:** {{ phase.status | replace('_', ' ') | title }}

{% if phase.checklist %}
**Checklist Progress:** {{ phase.checklist.completed }}/{{ phase.checklist.total }} items

**Completed Items:**
{% for item in phase.checklist.items %}
{% if item.status == 'completed' %}
- ✓ {{ item.text }}
{% elif item.status == 'skipped' %}
- ⊘ {{ item.text }} (Skipped: {{ item.skip_reason }})
{% endif %}
{% endfor %}
{% endif %}

{% endfor %}

---

## Key Decisions

{% for decision in decisions %}
### {{ decision.tree_name }}

**{{ decision.timestamp }}** - {{ decision.option }}
- Confidence: {{ decision.confidence | upper }}
- Operator: {{ decision.operator }}
{% if decision.rationale %}
- Rationale: {{ decision.rationale }}
{% endif %}

{% endfor %}

---

## Evidence Log Summary

**Total Evidence Entries:** {{ evidence.total_entries }}
**Chain Integrity:** {{ 'Verified ✓' if evidence.verified else 'FAILED ✗' }}

### Entry Breakdown

{% for type, count in evidence.type_counts.items() %}
- {{ type | replace('_', ' ') | title }}: {{ count }}
{% endfor %}

---

{% if lessons_learned %}
## Lessons Learned

{{ lessons_learned }}

{% endif %}

---

## Report Metadata

- **Generated By:** ISORA v{{ version }}
- **Report Time:** {{ generated_at }}
- **Incident ID:** {{ incident.id }}
- **Classification:** {{ 'SIMULATION/TRAINING' if incident.is_simulation else 'PRODUCTION INCIDENT' }}

*This report was generated by ISORA, an incident response decision support tool.*
